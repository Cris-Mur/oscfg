#!/bin/bash

# Opciones del menÃº
options=("Iniciar servicio" "Detener servicio" "Reiniciar servicio" "Ver estado" "Salir")
selected=0

# FunciÃ³n para dibujar menÃº
draw_menu() {
    clear
    tput setaf 4; tput bold
    echo "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
    echo "â•‘        ğŸš€ MENÃš INTERACTIVO ğŸš€       â•‘"
    echo "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
    tput sgr0
    echo

    for i in "${!options[@]}"; do
        if [[ $i == $selected ]]; then
            tput setaf 2; tput bold
            printf " â–º %s\n" "${options[$i]}"
            tput sgr0
        else
            printf "   %s\n" "${options[$i]}"
        fi
    done

    echo
    tput setaf 3
    echo "[Usa â†‘ â†“ para moverte | Enter para elegir | q o ESC para salir]"
    tput sgr0
}

# FunciÃ³n para ejecutar acciÃ³n
run_action() {
    case $selected in
        0) echo "ğŸ”µ Iniciando servicio..."; sleep 1 ;;
        1) echo "ğŸ”´ Deteniendo servicio..."; sleep 1 ;;
        2) echo "ğŸŸ¡ Reiniciando servicio..."; sleep 1 ;;
        3) echo "ğŸ“Š Mostrando estado..."; sleep 1 ;;
        4) echo "ğŸ‘‹ Saliendo..."; exit 0 ;;
    esac
}

# Bucle principal
while true; do
    draw_menu

    # Leer tecla (soporte para flechas y ESC)
    IFS= read -rsn1 input
    if [[ $input == $'\x1b' ]]; then
        read -rsn2 -t 0.001 rest
        input+=$rest
    fi

    case $input in
        $'\x1b[A') ((selected--));;  # Flecha arriba
        $'\x1b[B') ((selected++));;  # Flecha abajo
        "") run_action ;;            # Enter
        q|Q) echo "ğŸ‘‹ Saliendo..."; exit 0 ;;
        $'\x1b') echo "ğŸ‘‹ Saliendo..."; exit 0 ;;  # ESC
    esac

    # Limitar selecciÃ³n
    ((selected < 0)) && selected=0
    ((selected >= ${#options[@]})) && selected=$((${#options[@]} - 1))
done

